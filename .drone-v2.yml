name: default

kind: pipeline
type: docker


steps:
- name: push commit
  image: appleboy/drone-git-push:0.2.0-linux-amd64
  settings:
    branch: create-notify
    remote: git@github.com:HelloSanta/php4drupal.git
    force: false
    commit: true
    ssh_key:
      from_secret: ssh_key

- name: send
  image: plugins/webhook
  settings:
    urls:
      from_secret: mattermost_webhook
    content_type: application/json
    template: |
      {
        "channel": "docker-build-automation",
        "username": "Docker通知機器人",
        "text": "專案:{{ build.repo_name }} 分支:{{ build.branch }} 執行編號:{{ build.number }} 訊息:{{ build.commit_message }}  建立狀態:{{ build.status }}  查看連結:{{ build.link }}"
      }
  when:
    status:
    - failure
    - success
